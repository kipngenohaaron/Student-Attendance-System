{% extends 'hod_template/base_template.html' %}

{% block page_title %}
  Add Student
{% endblock page_title %}

{% block main_content %}
{% load static %}

<section class="content">
  <div class="container-fluid">

    <div class="row justify-content-center">
      <div class="col-md-10">
        <!-- Card Container -->
        <div class="card shadow-lg border-0" style="border-radius: 15px; overflow: hidden;">
          <!-- Header -->
          <div class="card-header text-white" style="background: linear-gradient(90deg, #0d6efd, #1e2a38);">
            <h3 class="card-title mb-0">
              <i class="fas fa-user-plus"></i> Add Student
            </h3>
          </div>

          <!-- Form -->
          <div class="card-body p-4" style="background-color: #f9fbfc;">
            {% url 'add_student_save' as action_path %}
            {% include 'hod_template/form_template.html' with messages=messages form=form action_path=action_path button_text="Add Student" %}
          </div>

          <!-- Footer -->
          <div class="card-footer text-muted text-center">
            <small>Ensure all fields are correctly filled before submission.</small>
          </div>
        </div>
      </div>
    </div>

  </div><!-- /.container-fluid -->
</section>

{% endblock main_content %}


{% block custom_js %}
<script>
  $(document).ready(function(){
    // Email availability check
    $("#id_email").keyup(function(){
      var email = $(this).val();
      if(email !== ""){
        $.ajax({
          url : '{% url "check_email_exist" %}',
          type : 'POST',
          data : {email:email},
        })
        .done(function(response){
          $(".email_error").remove();
          let color = response == "True" ? "red" : "green";
          let text = response == "True" ? "Email Not Available" : "Email Available";
          $("<span class='email_error' style='color:" + color + "; font-weight:600; display:block; margin-top:5px;'>" + text + ".</span>").insertAfter("#id_email");
        })
        .fail(function(){
          console.log("Failed to validate email.");
        });
      } else {
        $(".email_error").remove();
      }
    });

    // Username availability check
    $("#id_username").keyup(function(){
      var username = $(this).val();
      if(username !== ""){
        $.ajax({
          url : '{% url "check_username_exist" %}',
          type : 'POST',
          data : {username:username},
        })
        .done(function(response){
          $(".username_error").remove();
          let color = response == "True" ? "red" : "green";
          let text = response == "True" ? "Username Not Available" : "Username Available";
          $("<span class='username_error' style='color:" + color + "; font-weight:600; display:block; margin-top:5px;'>" + text + ".</span>").insertAfter("#id_username");
        })
        .fail(function(){
          console.log("Failed to validate username.");
        });
      } else {
        $(".username_error").remove();
      }
    });
  });
</script>
{% endblock custom_js %}
